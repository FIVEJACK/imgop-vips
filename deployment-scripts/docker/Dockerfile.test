# Dockerfile for local Lambda testing
FROM public.ecr.aws/lambda/provided:al2

# Copy the function code
COPY build/bootstrap ${LAMBDA_TASK_ROOT}/bootstrap

# Copy libvips layer (if built)
# COPY build/libvips.zip /tmp/libvips.zip
# RUN cd /opt && unzip /tmp/libvips.zip && rm /tmp/libvips.zip

# Set environment variables
ENV LD_LIBRARY_PATH=/opt/lib:${LD_LIBRARY_PATH}
ENV PATH=/opt/bin:${PATH}

# Make bootstrap executable
RUN chmod +x ${LAMBDA_TASK_ROOT}/bootstrap

# Set the CMD to your handler
CMD [ "bootstrap" ]

